//ARDUINO INTERVALOMETER CODE
//On demand the arduino will set pin 12 high which will be connected to an opto-coupler which will release the shutter of the dslr
//'take a picture', and with every 'shutter click' will turn the Arduino's on board LED on.

#include <Wire.h>
int LED = 13;
int optocoupler = 12;
int PictureCount;
bool run = false;

int test1;
int test2;
int test3;

void setup()
{
  Serial.begin(9600);
  Serial.println("Intervalometer Test!");
  //initialize the digital pin to be outputs
  pinMode(LED, OUTPUT);
  pinMode(opto, OUTPUT);
  //PictureCount would be changed by serial bus from the Controller RPI
}

// the loop routine runs over and over again forever:
void loop()
{
      if(run == true){
         for (int i = 0; i <= ShutterCount; i++){
            digitalWrite(LED, HIGH);   //Set LED to on
            digitalWrite(optocoupler, HIGH);
            test1++;
            delay(1000);               //Second Delay
            digitalWrite(LED, LOW);    //Set LED to off
            digitalWrite(optocoupler, LOW);   //Turn off OPTOCOUPLER
            delay(1000);
          }
       PictureCount = 0;
       run = false;
       }
      else
      {
      }
}


void test1()
{
 ShutterCount = 500;
 run = true;
   if(test1 == 500)
   {
      Serial.println("The intervalometer ran for the correct 500 count");
   }
  else
  {
  Serial.println("The intervalometer did not run for the expected output (# of times)");
  }
}

 




